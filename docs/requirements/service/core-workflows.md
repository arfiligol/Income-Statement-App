# 核心工作流程 (Core Workflows)

本應用程式主要支援律師事務所的兩大帳務工作流程。

## 1. 自動填寫律師代碼 (Auto Fill Lawyer Codes)
**目標**: 根據「摘要」欄位的文字內容，自動填入「備註」(Remark) 欄位的律師代碼。

-   **輸入**: 含有帳務明細的 Excel 檔案。
-   **流程**:
    1.  讀取檔案。
    2.  掃描「摘要」欄位是否包含已知的律師代碼 (例如 "HL", "JH")。
    3.  若發現，將代碼填入「備註」欄位。
        -   **替換邏輯**: 若代碼有設定「替換規則」(例如 KW -> KW, HL)，則自動展開。
    4.  若未發現，提示使用者手動選擇或輸入代碼 (透過對話框)。
        -   使用者可選擇「確認」、「略過單筆」或「略過全部」 (中斷邏輯)。
-   **輸出**: 修改後的 Excel 檔案 (In-place)。

## 2. 律師收入明細分帳 (Separate Ledger)
**目標**:根據「備註」欄位的律師代碼，將共同收入/支出拆分給各位律師。

-   **輸入**: Excel 檔案 (通常先經由自動填寫流程處理過)。
-   **目標工作表**: 尋找名稱為「明細分類帳」的工作表。
-   **流程**:
    1.  讀取每一列。
    2.  檢查「備註」欄位是否包含多個律師代碼 (例如 "HL JH")。
    3.  將借方/貸方金額平均除以律師人數。
    4.  在輸出結果中為每位律師建立一列，填入拆分後的金額。
-   **輸出**: 包含已拆分明細的新 Excel 檔案。
